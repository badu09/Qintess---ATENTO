@isTest
private class TestEmailEntrada {

	static testMethod void testInBoundEmail()
    {
       	// create a new email and envelope object
       	EmailEntrada objEmailEntrada = new EmailEntrada();
       	Messaging.InboundEmail email = new Messaging.InboundEmail() ;
       	Messaging.InboundEnvelope env = new Messaging.InboundEnvelope();
       	EmailServicesAddress objEmailServicesAddress = DAOEmailServicesAddress.getByLocalPart('emailleadprocess');
    	String emailLead = objEmailServicesAddress != null ? ('emailleadprocess@' + objEmailServicesAddress.EmailDomainName) : 'someaddress@email.com';
    	
       	// setup the data for the email
      	email.subject = 'Prospect Middle';
      	email.fromAddress = emailLead;
      	email.toAddresses = new List<String>{emailLead};
      	email.htmlBody = '<h1 ><center>PROSPECT EMPRESA - 11/10/17 11:02</center></h1><h2 ><center>Inclusão de um novo Prospect Empresa através do site Alelo</center></h2><p><center>Seguem os dados do cadastro de Prospect Empresa que acaba de ser incluído:</center></p><table  width="80%"  >  <tr>    <th colspan="2" ><center>Dados Cadastrais<center></th>  </tr>  <tr>   <th width="40%"  >CNPJ:</th>   <td width="60%"  >50165529000133</td> </tr> <tr>   <th width="40%"  >Razão Social:</td>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >Nome Fantasia:</th>     <td width="60%" >Teste PREPAGOS OP</td>   </tr>   <tr>     <th width="40%"  >Número de Funcionários:</th>     <td width="60%" >200</td>   </tr>   <tr>     <th width="40%"  >É Orgão público:</th>     <td width="60%" >Sim</td>   </tr>   <tr>     <th width="40%"  >Estado:</th>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >Município:</th>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >Bairro:</th>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >Endereço:</th>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >Número:</th>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >Complemento:</th>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >CEP:</th>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >Nome do Contato:</th>     <td width="60%" >dhiego bsi</td>   </tr>   <tr>     <th width="40%"  >DDD:</th>     <td width="60%" >11</td>   </tr>   <tr>     <th width="40%"  >Telefone:</th>     <td width="60%" >965156201</td>   </tr>   <tr>     <th width="40%"  >E-mail:</th>     <td width="60%" >dhiego.santos@bsitecnologia.com.br</td>   </tr>   <tr>     <th width="40%"  >Receber informações:</th>     <td width="60%" ></td>   </tr>   <tr>     <th width="40%"  >Dada do Cadastro:</th>     <td width="60%" >11/10/17 11:02</td>   </tr> </table> <table width="80%" >  <tr>    <td width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Refeição</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Sim</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>    <td  width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Flex Car</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>  </tr>  <tr>    <td width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Alimentação</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>    <td  width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Gestão de Vale-Transporte</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>  </tr>  <tr>    <td width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Natal Alimentação</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>    <td  width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Vale-Cultura</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Sim</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>  </tr>  <tr>    <td width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Alelo Auto</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>    <td  width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Alelo-Premiacao</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>  </tr>  <tr>    <td width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Alelo Incentivo</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>    <td  width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Alelo-Despesas</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>  </tr>  <tr>    <td width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Alelo Pagamentos</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>    <td  width="50%">      <table  width="90%" >        <tr>          <th colspan="2" ><center>Alelo Pronto</center></th>        </tr>        <tr>          <th  width="50%" >Tem Interesse:</th>          <td >Não</td>        </tr>        <tr>          <th  width="50%" >Quantidade:</th>          <td >-</td>        </tr>        <tr>          <th  width="50%" >Valor:</th>          <td >-</td>        </tr>      </table>    </td>  </tr></table><div>  <center><a href="http://www.alelo.com.br">www.alelo.com.br</a></center></div>';

//      	// add an Binary attachment
//      	Messaging.InboundEmail.BinaryAttachment attachment = new Messaging.InboundEmail.BinaryAttachment();
//      	attachment.body = blob.valueOf('my attachment text');
//      	attachment.fileName = 'textfileone.txt';
//      	attachment.mimeTypeSubType = 'text/plain';
//      	email.binaryAttachments = new Messaging.inboundEmail.BinaryAttachment[] { attachment };
//
//      	// add an Text atatchment
//      	Messaging.InboundEmail.TextAttachment attachmenttext = new Messaging.InboundEmail.TextAttachment();
//      	attachmenttext.body = 'my attachment text';
//      	attachmenttext.fileName = 'textfiletwo3.txt';
//      	attachmenttext.mimeTypeSubType = 'texttwo/plain';
//      	email.textAttachments =   new Messaging.inboundEmail.TextAttachment[] { attachmenttext };
      
      	// call the email service class and test it with the data in the testMethod
	    objEmailEntrada.handleInboundEmail(email, env);
    	Messaging.InboundEmailResult result = objEmailEntrada.handleInboundEmail(email, env);
    	system.assertEquals(result.success, true);
    }
}